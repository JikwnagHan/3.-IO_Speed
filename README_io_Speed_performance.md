# IO Speed Performance Automation (v0.7)

이 문서는 `io_Speed_performance_v_0.7.ps1` 스크립트를 사용해 SecuDesk 환경의 일반 영역과 보안 영역 간 입출력 속도를 자동으로 측정하는 방법을 안내합니다. 초보자도 쉽게 따라 할 수 있도록 실행 준비부터 보고서 확인까지 단계별로 정리했습니다.

## 1. 요구 사항

- Windows PowerShell 5.1 이상 (관리자 권한 권장)
- 일반 영역과 보안 영역으로 사용할 **두 개 이상의 드라이브 문자**
- 약 5GB 이상의 여유 공간 (샘플 데이터 10종 × 반복 측정 파일 생성)
- 결과 파일을 저장할 수 있는 폴더 또는 드라이브

## 2. 스크립트 개요

`io_Speed_performance_v_0.7.ps1`은 다음과 같은 순서로 실행됩니다.

1. 일반·보안 영역 드라이브, 샘플 데이터 폴더, 결과 저장 위치를 입력받습니다.
2. 입력받은 드라이브에 `Normal_Zone`, `Secure_Zone` 폴더를 만들고 비웁니다.
3. 지정한 샘플 데이터 폴더를 초기화하고 10개의 난수 데이터 파일을 생성합니다.
4. 각 파일을 일반 → 보안 순서로 쓰고 다시 읽는 과정을 10회 반복합니다.
5. 측정된 지연 시간과 MB/s를 계산해 CSV, XLSX, DOCX 보고서를 생성합니다.
6. 콘솔에 생성된 파일 위치를 출력합니다.

## 3. 실행 전 준비

1. PowerShell을 **관리자 권한**으로 실행합니다.
2. 스크립트가 위치한 폴더(예: `C:\Scripts`)로 이동합니다.
3. 필요 시 실행 정책을 일시적으로 허용합니다.
   ```powershell
   Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
   ```

## 4. 실행 방법

```powershell
cd C:\Scripts
pwsh -File .\io_Speed_performance_v_0.7.ps1
```

실행 후 다음 순서대로 질문이 표시됩니다.

| 질문 | 입력 예시 | 설명 |
| --- | --- | --- |
| 일반영역 디스크 드라이브 (예: D:\ 또는 E:\) : | `D`, `D:`, `D:\` | 일반 영역으로 사용할 드라이브 문자. 어떤 형식으로 입력해도 자동 정리됩니다. |
| 보안영역 디스크 드라이브 (예: E:\ 또는 D:\) : | `E`, `E:`, `E:\` | 보안 영역 드라이브 문자. 일반 영역과 달라야 합니다. |
| 샘플 데이터 위치 (예: D:\Dataset, 기존 파일은 삭제하여 10개 샘플을 생성합니다.) : | `E:\DataSet` | 샘플 파일을 생성·삭제할 폴더. 기존 내용은 모두 삭제됩니다. |
| 결과 데이터 저장 위치 (예: D:\logs) : | `E:\ResultData` | CSV·XLSX·DOCX 파일을 저장할 폴더 또는 `*.xlsx` 파일 경로. |

## 5. 생성되는 결과물

실행이 완료되면 다음 파일이 생성됩니다.

| 파일 | 설명 |
| --- | --- |
| `csv/IO_Performance_<timestamp>.csv` | 10회 반복 측정으로 수집한 모든 읽기/쓰기 기록. |
| `csv/IO_Performance_Summary_<timestamp>.csv` | 시나리오(일반/보안)와 작업(읽기/쓰기)별 평균 지연·속도 요약. |
| `csv/IO_Performance_Ratios_<timestamp>.csv` | 일반 대비 보안 영역 성능 비율과 90% 충족 여부. |
| `IO_Performance_Report_<timestamp>.xlsx` | Summary/Details 시트를 포함한 Excel 보고서. 결과 위치를 파일로 지정하면 해당 경로에 저장됩니다. |
| `IO_Performance_Analysis_Report_<timestamp>.docx` | 요구된 6개 항목(개요, 결과, 절차, 데이터, 검증, 결론)을 포함한 Word 보고서. |

## 6. 보고서 해석 팁

- Word 보고서 2장(성능시험 결과)에 종합 Pass/Fail 여부가 명시됩니다.
- CSV/Excel 파일에서 `WriteMBps`, `ReadMBps` 열을 확인하면 지연 시간 외에도 속도 추이를 파악할 수 있습니다.
- `IO_Performance_Ratios_*.csv`의 `SecureVsNormalPct` 값이 90 이상이면 해당 작업이 기준을 충족합니다.

## 7. 문제 해결

| 증상 | 해결 방법 |
| --- | --- |
| 드라이브 문자를 잘못 입력했다는 경고 | 올바른 드라이브 문자(`C`, `D:` 등)를 다시 입력하세요. 스크립트가 `C:\` 형태로 자동 보정합니다. |
| 샘플 데이터 폴더가 삭제되지 않음 | 해당 폴더의 파일을 사용 중인 프로그램이 없는지 확인하고, 필요하면 수동으로 비운 뒤 다시 실행합니다. |
| 결과 파일이 생성되지 않음 | PowerShell을 관리자 권한으로 실행했는지, 결과 경로에 쓰기 권한이 있는지 확인합니다. |

## 8. 후속 조치

- 측정 값이 기준(90%)에 미달하면 보안 정책(암호화, 실시간 검사 등)을 조정한 뒤 재측정을 권장합니다.
- 반복 측정 간 편차가 크다면 백그라운드 작업을 최소화하고 다시 실행해 보세요.

---

문의 사항이 있으면 스크립트 상단 주석을 참고하거나, 측정 로그(CSV)를 함께 공유해 주세요.
