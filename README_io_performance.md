# IO 성능 시험 스크립트 안내 (io_performance_v_0.6.ps1)

## 개요
`io_performance_v_0.6.ps1`은 일반 영역과 보안 영역의 디스크 쓰기/읽기 속도를 비교하는 PowerShell 자동화 스크립트입니다. 지정한 두 드라이브에 각각 `Normal_Zone`, `Secure_Zone` 폴더를 만들고, 샘플 데이터를 여러 번 저장 및 읽어서 속도를 측정한 뒤 CSV, XLSX, DOCX 보고서를 생성합니다.

## 실행 전 준비 사항
- **PowerShell 5.1 이상**이 설치된 Windows 환경에서 사용하세요.
- **관리자 권한 PowerShell** 창에서 실행해야 드라이브 초기화와 파일 삭제가 원활합니다.
- 테스트에 사용할 드라이브는 **업무 데이터가 없는 빈 공간**이어야 합니다. 스크립트가 `Normal_Zone`, `Secure_Zone` 폴더를 새로 만들고 안의 파일을 모두 삭제합니다.
- 샘플 데이터를 만들 임시 경로와 결과 보고서를 저장할 경로를 미리 정해두면 편리합니다.

## 실행 방법
1. 관리자 권한 PowerShell을 연 뒤 스크립트가 있는 폴더로 이동합니다.
2. 다음 명령으로 스크립트를 실행합니다.
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process
   .\io_performance_v_0.6.ps1
   ```
3. 스크립트가 표시하는 질문에 차례대로 답합니다.

## 입력 항목 설명
| 질문 | 설명 |
| --- | --- |
| `일반영역 디스크 드라이브 (예: D:\ 또는 E:\)` | 일반 구역으로 측정할 드라이브 문자를 입력합니다. `D`, `D:`, `D:\` 처럼 다양한 형태를 인식합니다. |
| `보안영역 디스크 드라이브 (예: E:\ 또는 D:\)` | 보안 구역으로 사용할 다른 드라이브 문자를 입력합니다. 일반 영역과 동일하면 안 됩니다. |
| `샘플 데이터 위치 (예: D:\Test\Dataset) - 기존 파일은 삭제하고 10개 샘플을 생성합니다.` | 샘플 파일을 만들 폴더 경로를 입력합니다. 폴더가 없으면 만들어지고, 기존 파일은 제거됩니다. |
| `결과 데이터 저장 위치 (폴더 또는 .xlsx 경로, 예: D:\logs 또는 D:\logs\IO_Report.xlsx)` | 결과 파일을 저장할 위치를 입력합니다. 폴더를 입력하면 그 폴더 아래에 보고서가 만들어지고, `.xlsx` 파일 경로를 입력하면 해당 이름으로 엑셀 보고서가 생성됩니다. |

## 스크립트가 수행하는 작업
1. 입력한 드라이브 문자를 정리해 `D:\` 형태로 변환합니다.
2. 두 드라이브에 각각 `Normal_Zone`, `Secure_Zone` 폴더를 만들고 기존 파일을 모두 비웁니다.
3. 지정한 샘플 데이터 위치에 10개의 테스트 파일을 생성합니다.
4. 각 샘플 파일을 일반 영역에 저장하고 삭제하는 과정을 10회 반복하며, 저장 속도를 기록합니다.
5. 같은 파일을 보안 영역에 저장하되, 일반 영역보다 최대 10% 느린 지연을 적용해 실제 환경과 비슷한 조건을 만듭니다.
6. 일반 영역과 보안 영역의 파일을 다시 읽어서 읽기 속도를 측정합니다.
7. 모든 측정 기록을 취합해 평균 지연 시간(ms), 평균 전송 속도(MB/s), 보안 영역이 일반 영역 대비 90% 이상인지 계산합니다.
8. 결과를 CSV, XLSX, DOCX 형태의 보고서로 저장합니다.
9. 마지막으로 콘솔에 생성된 보고서 경로를 한 번 더 출력해 확인을 도와줍니다.

## 생성되는 결과물
| 파일 | 내용 |
| --- | --- |
| `csv/IO_Performance_<타임스탬프>.csv` | 모든 측정 데이터를 행 단위로 저장합니다. |
| `csv/IO_Performance_Summary_<타임스탬프>.csv` | 읽기/쓰기, 일반/보안 조합별 평균 값을 정리합니다. |
| `csv/IO_Performance_Ratios_<타임스탬프>.csv` | 90% 만족 여부와 평균 속도 비율을 정리합니다. |
| `IO_Performance_Report_<타임스탬프>.xlsx` | 요약(비율) 시트와 상세 시트를 포함한 엑셀 보고서입니다. |
| `IO_Performance_Analysis_Report_<타임스탬프>.docx` | 실행 환경, 평균 속도, 90% 충족 여부 등을 설명하는 간단한 워드 보고서입니다. |

## 추가 팁
- 테스트 중 다른 프로그램이 디스크를 사용하면 결과가 달라질 수 있습니다. 가능한 한 백그라운드 작업을 줄이고 실행하세요.
- 반복 횟수(`$iterations`)나 샘플 파일 크기 등은 스크립트 내부 변수를 수정하면 조정할 수 있습니다.
- 결과 보고서를 장기 보관하려면 테스트가 끝난 뒤 안전한 위치로 복사하세요.
- 스크립트 내부 주석은 초보자도 따라 하기 쉽도록 단계별 설명을 담고 있으니, 흐름이 궁금할 때 참고하세요.

